<!DOCTYPE html>
<html lang="en">
<head>
    <title>Matrix Admin</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../css/bootstrap.min.css" />
    <link rel="stylesheet" href="../css/bootstrap-responsive.min.css" />
    <link rel="stylesheet" href="../css/colorpicker.css" />
    <link rel="stylesheet" href="../css/datepicker.css" />
    <link rel="stylesheet" href="../css/uniform.css" />
    <link rel="stylesheet" href="../css/select2.css" />
    <link rel="stylesheet" href="../css/matrix-style2.css" />
    <link rel="stylesheet" href="../css/matrix-media.css" />
    <link rel="stylesheet" href="../css/bootstrap-wysihtml5.css" />
    <link href="../font-awesome/css/font-awesome.css" rel="stylesheet" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700,800' rel='stylesheet' type='text/css'>

    <style>
        .control-group .controls label{
            display:inline-block;
        }
        body {
            padding-bottom: 40px;
        }
        .sidebar-nav {
            padding: 9px 0;
        }

        @media (max-width: 980px) {
            /* Enable use of floated navbar text */
            .navbar-text.pull-right {
                float: none;
                padding-left: 5px;
                padding-right: 5px;
            }
        }

    </style>

</head>
<body>

<div id="content">
    <div id="content-header">
        <h1>基本情况</h1>
    </div>
    <div class="container-fluid">
        <div class="row-fluid">
            <div id="form_2" class="span12">
                <div class="widget-box">
                    <div class="widget-title"> <span class="icon"> <i class="icon-align-justify"></i> </span>
                        <h5>教育情况</h5>
                    </div>
                    <div class="widget-content nopadding">
                        <span id="span1" style="color: red;"></span>
                        <table id="t1" class="table table-bordered table-striped" frame="box">
                            <thead>
                            <tr><th colspan="6" >已添学历信息</th></tr>
                            <tr>
                                <th>学历</th>
                                <th>毕业学校</th>
                                <th>专业</th>
                                <th>获得学位时间</th>
                                <th>学位</th>
                                <th>性质</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr class="odd gradeX">
                                <td>本科</td>
                                <td>郑州大学</td>
                                <td>计算机科学与技术</td>
                                <td>1999.9-2003.7</td>
                                <td>学士</td>
                                <td>全日制</td>
                            </tr>
                            </tbody>
                        </table>

                        <form id="education" action="#" method="get" class="form-horizontal">
                            <input id="cuId" name="cuId" type="text" style="display: none">
                            <div class="control-group">
                                <label class="control-label">学历：</label>
                                <div class="controls">
                                    <select id="certificate"  name="certificate">
                                        <option value="本科">本科</option>
                                        <option value="硕士">硕士</option>
                                        <option value="博士">博士</option>
                                        <option value="最终学位">最终学位</option>
                                    </select>
                                </div>
                            </div>
                            <div class="control-group">
                                <label class="control-label">就读学校：</label>
                                <div class="controls">
                                    <input name="school" type="text" class="span11" placeholder="Last name" />
                                </div>
                            </div>
                            <div class="control-group">
                                <label class="control-label">所学专业 ：</label>
                                <div class="controls">
                                    <input name="major" type="text" class="span11" placeholder="Company name" />
                                </div>
                            </div>
                            <div class="control-group">
                                <label class="control-label">就读时间：</label>
                                <div class="controls">
                                    <input name="studyingTime" type="date" class="span11" placeholder="Company name" />
                                </div>
                            </div>
                            <div class="control-group">
                                <label class="control-label">毕业时间：</label>
                                <div class="controls">
                                    <input name="graduaTime" type="date" class="span11" placeholder="Company name" />
                                </div>
                            </div>
                            <div class="control-group">
                                <label class="control-label">学位 ：</label>
                                <div class="controls">
                                    <input name="degree" type="text" class="span11" />
                                </div>
                            </div>
                            <div class="control-group">
                                <label class="control-label">性质 ：</label>
                                <div class="controls">
                                    <select name="nature">
                                        <option>全日制</option>
                                        <option>在职</option>
                                    </select>
                                </div>
                            </div>
                        </form>
                        <center>
                            <div class="control-group">
                                <div class="controls">
                                    <label class="control-label">Excel：</label>
                                    <input id="excel"  type="file" size="15" style="opacity: 0;">
                                    <button id="leadIn" class="btn btn-primary btn-large" style="margin-bottom: 20px;border-radius: 5px">导入Excel</button>
                                </div>
                            </div>
                            <form action="/education/leadOut" method="post" style="display: inline-block;">
                                <input id="cuId2" name="cuId" type="text" style="display: none" >
                                <input type="submit" class="btn btn-info btn-large" style="margin-bottom: 20px;border-radius: 5px"; value="保存为Excel";>
                            </form>
                            <button id="btn1" class="btn btn-success btn-large" style="margin-bottom: 20px;border-radius: 5px">保存基本信息</button>
                        </center>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="http://www.jq22.com/jquery/jquery-1.7.1.js"></script>
<script src="../js/jquery.ui.custom.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script src="../js/bootstrap-colorpicker.js"></script>
<script src="../js/bootstrap-datepicker.js"></script>

<script src="../js/masked.js"></script>
<script src="../js/jquery.uniform.js"></script>
<script src="../js/select2.min.js"></script>
<script src="../js/matrix.js"></script>
<script src="../js/matrix.form_common.js"></script>
<script src="../js/wysihtml5-0.3.0.js"></script>
<script src="../js/jquery.peity.min.js"></script>
<script src="../js/bootstrap-wysihtml5.js"></script>
<script type="text/javascript" src="../js/jquery.cookie.js"></script>

<script>
    $(function () {
        var cuId=$.cookie("cuId");
        $("#cuId").val(cuId);
        $("#cuId2").val(cuId);
        //退出
        $('#backid').click(function(){
            window.location.href="index.html";
        });
        //保存
        $("#btn1").click(function () {
            var certificate=$("#certificate").val();
            var r = confirm("* 你当前添加学历为\t"+certificate+"\n"+
                "* 需提供资料：毕业证书、学位证书\n\n" +
                "\t\t您是否确定保存？")
            if (r == true) {
                addEducation();
            } else {

            }
        })
        //导入
        $("#leadIn").click(function () {
            var excel=$("#excel")[0].files[0];
            var formData = new FormData();
            formData.append("excel",excel);
            formData.append("cuId",cuId);
            $.ajax({
                url:'/education/leadIn',
                dataType:'json',
                type:'POST',
                async: false,
                data: formData,
                processData : false, // 使数据不做处理
                contentType : false, // 不要设置Content-Type请求头
                success: function(result){
                    console.log(result);
                    if (result.resp_code == '0') {
                        alert(result.resp_msg);
                        window.location.href="education.html";
                    }else {
                        $("#span1").text(result.resp_msg);
                    }
                },
                error:function(response){
                    console.log(response);
                }
            });
        })
    })


    //上传接口
    function addEducation() {
        console.log($('#education').serializeJson())
        $.ajax({
            type: "POST",
            dataType: "json",
            url: '../education',
            contentType: "application/json",
            data:JSON.stringify($('#education').serializeJson()),
            success: function (result) {
                console.log("data is :" + result)
                if (result.resp_code == "0") {
                    alert(result.resp_msg);
                    window.location.href="education.html";
                }else {
                    $("#span1").val(result.resp_msg);
                }
            }
        });
    }
    //form->json
    (function (window, $) {
        $.fn.serializeJson = function () {//form serialize to json
            var serializeObj = {};
            var array = this.serializeArray();
            $(array).each(
                function () {
                    if (serializeObj[this.name]) {
                        if ($.isArray(serializeObj[this.name])) {
                            serializeObj[this.name].push(this.value);
                        } else {
                            serializeObj[this.name] = [
                                serializeObj[this.name], this.value];
                        }
                    } else {
                        serializeObj[this.name] = this.value;
                    }
                });
            return serializeObj;
        };
    })(window, jQuery);
</script>
</body>
</html>
